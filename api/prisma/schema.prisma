// api/prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// MODELO DE USUÁRIO (ATUALIZADO)
model User {
  id            String    @id @default(uuid())
  email         String    @unique
  passwordHash  String    @map("password_hash")
  roles         String[]
  createdAt     DateTime  @default(now()) @map("created_at")

  // Relações
  refreshTokens RefreshToken[]
  questionario  Questionario? // Um usuário tem um questionário
}

// MODELO DO QUESTIONÁRIO (NOVO)
model Questionario {
  id            String   @id @default(uuid())
  objetivo      String?
  genero        String?
  anoNascimento String?
  altura        String?
  pesoAtual     String?
  pesoAlvo      String?
  // Adicione outros campos conforme o front-end

  // Relação: O questionário pertence a um usuário
  userId String @unique @map("user_id")
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
}

// MODELO DE REFRESH TOKEN (SEM ALTERAÇÕES)
model RefreshToken {
  jti       String   @id @default(uuid())
  expiresAt DateTime @map("expires_at")
  isRevoked Boolean  @default(false) @map("is_revoked")
  userId    String   @map("user_id")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}